<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js" type="text/javascript"></script>
  </head>
  <body>
    <span id="messageDisplay"></span>
    <span id="ResultDisplay"></span>
  </body>

  <script type="text/javascript">
    ThunkableWebviewerExtension.receiveMessageWithReturnValue(function(message, callback) {
      document.getElementById('messageDisplay').innerHTML = message;
      // 定义运算符集合
      const operators = ['+', '-', '*', '/', '%', '.', '^'];
      let result = '';

      // 检查 message 的最后两个字符是否都是运算符
      if (operators.includes(message[message.length - 1]) && operators.includes(message[message.length - 2])) {
        // 如果是，不返回任何内容
        result = '';
      } else {
        // 如果不是，返回最后一个字符（如果它是运算符）
        if (operators.includes(message[message.length - 1])) {
          result = message[message.length - 1];
        }
      }

      // 显示处理结果
      document.getElementById('ResultDisplay').innerHTML = result;
      // 返回处理结果
      callback(result);
    });
  </script>
</html>
